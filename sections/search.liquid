{%- liquid
  assign initial_visible_option_count = 6
  assign options = section.settings
  assign color_scheme = options.color_scheme
  assign img_ratio = options.img_ratio
  assign desktop_columns = options.desktop_columns
  assign mobile_columns = options.mobile_columns
  assign enable_filtering = options.enable_filtering
  assign enable_uppercase_title = options.enable_uppercase_title
  assign mobile_space_between_cards = options.mobile_space_between_cards | times: 0.1
  assign desktop_space_between_cards = options.desktop_space_between_cards | times: 0.1
  assign option_style = options.option_style
  assign product_per_page = options.product_per_page | times: 1.0
  assign show_results_count = options.show_results_count
  assign show_column_count_switcher = options.show_column_count_switcher
  assign enable_sorting = options.enable_sorting
  assign show_divider = options.show_divider
  assign show_color_swatches = options.show_color_swatches
  assign filter_style = options.filter_style
  assign filters_position = options.filters_position
  assign categories_style = options.categories_style
  assign active_filter_count = 0
  assign container_size = options.container_size
  assign pagination_type = options.pagination_type
  assign section_spacing_top = options.section_spacing_top
  assign section_spacing_bottom = options.section_spacing_bottom

  assign product_card_align = options.product_card_align

  for filter in search.filters
    for value in filter.values
      if value.active
        assign active_filter_count = active_filter_count | plus: filter.active_values.size
      endif
    endfor
  endfor

  for filter in search.filters
    if filter.type == 'price_range'
      assign max_price = filter.range_max
      assign max_value = filter.max_value.value
      assign min_value = filter.min_value.value
      if max_value < max_price or min_value > 0
        assign has_price_filtering = true
        break
      endif
    endif
  endfor

  if has_price_filtering
    assign active_filter_count = active_filter_count | plus: 1
  endif

  assign base_params = 'q=' | append: search.terms | append: '&options%5Bprefix%5D=last&'

  if search.filters.size == 0
    assign enable_filtering = false
  endif
-%}

{%- liquid
  assign default_tab = blank

  paginate search.results by 2000
    assign article_list = search.results | where: 'object_type', 'article'
    assign page_list = search.results | where: 'object_type', 'page'
  endpaginate

  assign article_count = 0
  assign page_count = 0
  assign product_count = 0

  assign page_count = page_list | size | default: 0
  assign article_count = article_list | size | default: 0
  assign product_count = search.results_count | minus: article_count | minus: page_count

  if product_count > 0
    if default_tab == blank
      assign default_tab = 'products'
    endif
    assign tabs_count = tabs_count | plus: 1
  endif

  if page_count > 0
    if default_tab == blank
      assign default_tab = 'pages'
    endif
    assign tabs_count = tabs_count | plus: 1
  endif

  if article_count > 0
    if default_tab == blank
      assign default_tab = 'articles'
    endif
    assign tabs_count = tabs_count | plus: 1
  endif

  assign show_products = false
  if product_count > 0 or search.filters.size > 0
    assign show_products = true
  endif

  assign show_pages = false
  if page_count > 0
    assign show_pages = true
  endif

  assign show_articles = false
  if article_count > 0
    assign show_articles = true
  endif

  if show_pages == false and show_articles == false and show_products == true
    assign default_tab = 'products'
  endif
-%}

{% capture css %}
   {% style %}

   .section-{{ section.id }}{
      --gsc-mobile-columns: {{ mobile_columns }};
      --gsc-desktop-columns: {{ desktop_columns }};
      --gsc-space-between-cards: {{ mobile_space_between_cards }}rem;

      --gsc-section-spacing-top: calc({{ section_spacing_top }}px + 6.4rem);
      --gsc-section-spacing-bottom: calc({{ section_spacing_bottom }}px + 6.4rem);
   }

   @media {% render 'media-queries', screen: 'md' %} {
      .section-{{ section.id }}{
         --gsc-space-between-cards: {{ desktop_space_between_cards }}rem;
      }
   }

   {% endstyle %}
{% endcapture %}

{% render 'inline-css-minifier', css: css %}

<div class='search section section-{{ section.id }} color-{{ color_scheme }} section-spacing'>
  <div class='search__container container container--small'>
    <form
      class='search__form'
      action='{{ routes.search_url }}'
      method='get'
      role='search'
      class='search'
      id='SearchPageForm'
    >
      <search-field class='search-field' data-sidebar-search-input-component data-with-load-focus>
        <label class='visually-hidden' for='SearchPageForm-QueryInput-{{ section.id }}'>
          {{- 'general.search_page.screen_reader.text_for_change_query' | t -}}
        </label>
        <input
          class='search-field__input'
          type='text'
          name='q'
          placeholder='{{ 'general.search_page.store_front.placeholder_for_search_input' | t }}'
          value='{{ search.terms | escape }}'
          data-sidebar-search-input
          data-search-field-input
          id='SearchPageForm-QueryInput-{{ section.id }}'
        >
        <div class='search-field__controls'>
          <button
            type='button'
            class='unstyled-button search-field__controls-item hidden'
            aria-label='{{ 'general.search_page.screen_reader.label_for_search_button' | t }}'
            data-search-field-reset-button
          >
            {% render 'icon',
              icon_name: 'close-large',
              class: 'search-field__controls-item-icon search-field__controls-item-icon--reset'
            %}
          </button>
          <button
            type='submit'
            form='SearchPageForm'
            class='unstyled-button search-field__controls-item'
            aria-label='{{ 'general.search_page.screen_reader.label_for_search_button' | t }}'
          >
            {% render 'icon', icon_name: 'main-search', class: 'search-field__controls-item-icon' %}
          </button>
        </div>
      </search-field>
      <input name='options[prefix]' type='hidden' value='last' id='SearchPageForm-OptionsPrefixInput-{{ section.id }}'>
    </form>
  </div>
  {%- if search.filters.size > 0 or search.results.size > 0 -%}
    <div class='search__results-container container container--{{ container_size }}'>
      <tabs-component data-selected-tab-id='{{ default_tab }}'>
        <div class='search__tab-name-list'>
          {%- if show_products == true -%}
            <div
              data-tabs-name
              class='tab-name search__tab-name {% if default_tab == 'products' %}selected{% endif %}'
              data-id='products'
              tabindex='0'
            >
              {{ 'general.search_page.store_front.products_tab' | t: count: product_count }}
            </div>
          {%- endif -%}
          {%- if show_articles == true -%}
            <div
              data-tabs-name
              class='tab-name search__tab-name {% if default_tab == 'articles' %}selected{% endif %}'
              data-id='articles'
              tabindex='0'
            >
              {{ 'general.search_page.store_front.blog_posts_tab' | t: count: article_count }}
            </div>
          {%- endif -%}
          {%- if show_pages == true -%}
            <div
              data-tabs-name
              class='tab-name search__tab-name {% if default_tab == 'pages' %}selected{% endif %}'
              data-id='pages'
              tabindex='0'
            >
              {{ 'general.search_page.store_front.pages_tab' | t: count: page_count }}
            </div>
          {%- endif -%}
        </div>
        <carousel-component
          class='carousel search__carousel-tab-names'
          data-contain-scroll='trimSnaps'
          data-section-id='{{ section.id }}'
          with-stop-on-hover
          data-draggable
          data-align='start'
          data-axis='x'
        >
          <div class='carousel__viewport carousel__viewport--overflow embla' data-carousel-viewport>
            <div class='carousel__container' data-carousel-container>
              {%- if show_products == true -%}
                <div
                  data-tabs-name
                  class='carousel__slide search__tab-name tab-name {% if default_tab == 'products' %}selected{% endif %}'
                  data-id='products'
                  tabindex='0'
                >
                  {{ 'general.search_page.store_front.products_tab' | t: count: product_count }}
                </div>
              {%- endif -%}
              {%- if show_articles == true -%}
                <div
                  data-tabs-name
                  class='carousel__slide search__tab-name tab-name {% if default_tab == 'articles' %}selected{% endif %}'
                  data-id='articles'
                  tabindex='0'
                >
                  {{ 'general.search_page.store_front.blog_posts_tab' | t: count: article_count }}
                </div>
              {%- endif -%}
              {%- if show_pages == true -%}
                <div
                  data-tabs-name
                  class='carousel__slide search__tab-name tab-name {% if default_tab == 'pages' %}selected{% endif %}'
                  data-id='pages'
                  tabindex='0'
                >
                  {{ 'general.search_page.store_front.pages_tab' | t: count: page_count }}
                </div>
              {%- endif -%}
            </div>
          </div>
        </carousel-component>
        <div class='tabs' data-tabs-container>
          <template data-tabs-elements-template>
            {%- if show_products == true and default_tab != 'products' -%}
              <tab-component class='tab' aria-hidden='true' data-id='products'>
                <sidebar-filters-sticky-mobile-button class='shop-mobile-filters-button'>
                  <button
                    data-sidebar-button
                    class='unstyled-button shop-mobile-filters-button__btn'
                    aria-label='{{ 'shop.screen_reader.label_for_filters_toggler' | t }}'
                    data-sidebar-id='SidebarFiltersMobile'
                    data-aria-expanded='false'
                  >
                    {% render 'icon', icon_name: 'filter-toggle' %}
                    <span class='shop-mobile-filters-button__btn-label'>
                      {{ 'shop.store_front.label_for_filters_toggler' | t }}
                    </span>
                  </button>
                </sidebar-filters-sticky-mobile-button>

                <shop-component
                  class='shop'
                  data-base-params='{{ base_params }}'
                  data-section-id='{{ section.id }}'
                  data-column-switcher-target
                >
                  <div class='shop__container'>
                    <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                      <div class='shop__header-left-panel {% if filters_position == 'right' %} shop__header-left-panel--reverse {% endif %}'>
                        {%- if enable_filtering or enable_sorting -%}
                          {%- if enable_filtering -%}
                            <sidebar-button class='shop__filters-btn-wrapper shop__filters-btn-wrapper--desktop'>
                              <button
                                data-sidebar-button
                                class='unstyled-button shop__icon-btn shop__filters-btn '
                                aria-label='{{ 'general.search_page.screen_reader.label_for_filters_toggler' | t }}'
                                data-sidebar-id='SidebarFiltersDesktop'
                                data-aria-expanded='{% if filter_style == 'open-embed' %}true{% else %}false{% endif %}'
                              >
                                {% render 'icon', icon_name: 'filter-toggle' %}
                                <span class='shop__filters-btn-label'>
                                  {{ 'general.search_page.store_front.label_for_filters_toggler' | t }}
                                </span>
                              </button>
                            </sidebar-button>
                            <sidebar-button class='shop__filters-btn-wrapper shop__filters-btn-wrapper--mobile'>
                              <button
                                data-sidebar-button
                                class='unstyled-button shop__icon-btn shop__filters-btn '
                                aria-label='{{ 'general.search_page.screen_reader.label_for_filters_toggler' | t }}'
                                data-sidebar-id='SidebarFiltersMobile'
                                data-aria-expanded='false'
                              >
                                {% render 'icon', icon_name: 'filter-toggle' %}
                                <span class='shop__filters-btn-label'>
                                  {{ 'general.search_page.store_front.label_for_filters_toggler' | t }}
                                </span>
                              </button>
                            </sidebar-button>
                          {%- endif -%}
                          {%- if enable_sorting -%}
                            {%- render 'sort-list', results: search -%}
                          {%- endif -%}
                        {% endif %}
                      </div>
                      <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                        {%- if show_results_count -%}
                          <div class='shop__product-count' id='ShopProductCount'>
                            {{ 'general.search_page.store_front.results_count' | t: count: product_count }}
                          </div>
                        {%- endif -%}
                        {%- if show_column_count_switcher %}
                          <column-switcher
                            class='shop__column-switcher--mobile column-switcher'
                            data-default='{{ mobile_columns }}'
                            data-column-switcher-css-variable='mobile-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (1..2) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) -%}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                        {%- if show_column_count_switcher -%}
                          <column-switcher
                            class='shop__column-switcher--desktop column-switcher'
                            data-default='{{ desktop_columns }}'
                            data-column-switcher-css-variable='desktop-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (2..4) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) -%}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                      </div>
                    </div>
                    {%- if enable_filtering -%}
                      {% render 'active-filters',
                        results: search,
                        has_price_filtering: has_price_filtering,
                        active_filter_count: active_filter_count
                      %}
                    {%- endif -%}
                    <div class='shop__content'>
                      {%- if enable_filtering -%}
                        {% render 'filters',
                          active_filter_count: active_filter_count,
                          show_divider: show_divider,
                          filter_style: filter_style,
                          categories_style: categories_style,
                          filters_position: filters_position,
                          show_color_swatches: show_color_swatches,
                          option_style: option_style,
                          enable_uppercase_title: enable_uppercase_title,
                          initial_visible_option_count: initial_visible_option_count,
                          results: search
                        %}
                      {%- endif -%}
                      <div class='shop__products' id='ShopProducts'>
                        {% paginate search.results by product_per_page %}
                          {%- if search.results.size > 0 -%}
                            <div class='shop__products-grid-wrap'>
                              <div class='shop__products-grid' id='ShopProductsGrid'>
                                {%- for item in search.results -%}
                                  {%- comment %}<locksmith:4521>{% endcomment -%}
                                    {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: item, subject_parent: search, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                                  {%- comment %}</locksmith:4521>{% endcomment -%}
                                  {%- if item.object_type == 'product' -%}
                                    <div class='main-search__item shop__grid-item'>
                                      {% render 'product-card',
                                        with_bottom_spacing: true,
                                        product: item,
                                        show_mobile_carousel: true,
                                        img_ratio: img_ratio,
                                        product_card_align: product_card_align
                                      %}
                                    </div>
                                  {%- endif -%}
                                {%- endfor -%}
                              </div>
                              {% render 'loading-overlay', class: 'shop__loading-overlay', id: 'ShopProductsOverlay' %}
                            </div>
                          {%- else -%}
                            {%- if active_filter_count > 0 -%}
                              <div class='shop__products-stub'>
                                <span>
                                  {{- 'general.search_page.store_front.text_for_no_results_found_in_stub' | t -}}
                                </span>
                                <span>
                                  {{- 'general.search_page.store_front.text_for_use_another_filters' | t }}
                                  <filter-remove-btn class='shop__filters-reset' data-url='{{ routes.search_url }}'>
                                    {{- 'general.search_page.store_front.text_for_clear_all_in_stub' | t -}}
                                  </filter-remove-btn></span
                                >
                                {% render 'loading-overlay',
                                  class: 'shop__loading-overlay',
                                  id: 'ShopProductsOverlay'
                                %}
                              </div>
                            {%- else -%}
                              <div class='shop__products-stub'>
                                <span>{{ 'general.search_page.store_front.text_for_change_query' | t }}</span>
                                {% render 'loading-overlay',
                                  class: 'shop__loading-overlay',
                                  id: 'ShopProductsOverlay'
                                %}
                              </div>
                            {%- endif -%}
                          {%- endif -%}

                          {%- liquid
                            if paginate.pages > 1
                              case pagination_type
                                when 'load-button-pagination'
                                  render 'load-button-pagination', class: 'shop__load-button-pagination', paginate: paginate, target: 'shop__grid-item', container_id: 'ShopProductsGrid', all_count: product_count, current_size: paginate.page_size
                                when 'classic-pagination'
                                  render 'classic-pagination', class: 'shop__classic-pagination', paginate: paginate, overlay_id: 'ShopProductsOverlay', container_id: 'ShopProductsGrid'
                                when 'infinite-scroll'
                                  render 'infinite-scroll-pagination', class: '', paginate: paginate, target: 'shop__grid-item', container_id: 'ShopProductsGrid'
                              endcase
                            endif
                          -%}
                        {% endpaginate %}
                      </div>
                    </div>
                  </div>
                </shop-component>
              </tab-component>
            {%- endif -%}
            {%- if show_pages == true and default_tab != 'pages' -%}
              <tab-component class='tab' aria-hidden='true' data-id='pages'>
                <div class='shop' data-column-switcher-target>
                  <div class='shop__container'>
                    <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                      <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                        {%- if show_results_count -%}
                          <div class='shop__product-count'>
                            {{ 'general.search_page.store_front.results_count' | t: count: page_count }}
                          </div>
                        {%- endif -%}
                        {%- if show_column_count_switcher -%}
                          <column-switcher
                            class='shop__column-switcher--mobile column-switcher'
                            data-default='{{ mobile_columns }}'
                            data-column-switcher-css-variable='mobile-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (1..2) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) -%}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                        {%- if show_column_count_switcher -%}
                          <column-switcher
                            class='shop__column-switcher--desktop column-switcher'
                            data-default='{{ desktop_columns }}'
                            data-column-switcher-css-variable='desktop-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (2..4) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) %}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                      </div>
                    </div>
                    <div class='shop__content'>
                      <div class='shop__products'>
                        <div class='shop__products-grid-wrap'>
                          <div class='shop__products-grid'>
                            {%- for page in page_list -%}
                              {%- comment %}<locksmith:f2fb>{% endcomment -%}
                                {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: page, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                              {%- comment %}</locksmith:f2fb>{% endcomment -%}
                              <div class='main-search__item shop__grid-item'>
                                {% render 'page-card', page: page, img_ratio: img_ratio, with_small_icon: false %}
                              </div>
                            {%- endfor -%}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </tab-component>
            {%- endif -%}
            {%- if show_articles == true and default_tab != 'articles' -%}
              <tab-component class='tab' aria-hidden='true' data-id='articles'>
                <div class='shop' data-column-switcher-target>
                  <div class='shop__container'>
                    <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                      <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                        {%- if show_results_count -%}
                          <div class='shop__product-count'>
                            {{ 'general.search_page.store_front.results_count' | t: count: article_count }}
                          </div>
                        {%- endif -%}
                        {%- if show_column_count_switcher -%}
                          <column-switcher
                            class='shop__column-switcher--mobile column-switcher'
                            data-default='{{ mobile_columns }}'
                            data-column-switcher-css-variable='mobile-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (1..2) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) -%}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                        {%- if show_column_count_switcher -%}
                          <column-switcher
                            class='shop__column-switcher--desktop column-switcher'
                            data-default='{{ desktop_columns }}'
                            data-column-switcher-css-variable='desktop-columns'
                            data-section-id='{{ section.id }}'
                          >
                            {%- for column_switch in (2..4) -%}
                              {%- assign column_switch_string = column_switch | append: '' -%}
                              <div
                                class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                                data-column-switcher-item
                                tabindex='0'
                                data-value='{{ column_switch }}'
                              >
                                {%- for i in (1..column_switch) -%}
                                  <span></span>
                                {%- endfor -%}
                              </div>
                            {%- endfor -%}
                          </column-switcher>
                        {%- endif -%}
                      </div>
                    </div>
                    <div class='shop__content'>
                      <div class='shop__products'>
                        <div class='shop__products-grid-wrap'>
                          <div class='shop__products-grid'>
                            {%- for article in article_list -%}
                              {%- comment %}<locksmith:53f3>{% endcomment -%}
                                {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: article, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                              {%- comment %}</locksmith:53f3>{% endcomment -%}
                              <div class='main-search__item shop__grid-item'>
                                {% render 'article-card',
                                  with_bottom_spacing: true,
                                  article: article,
                                  img_ratio: img_ratio,
                                  show_read_more: true,
                                  show_subheading: true,
                                  show_comment_count: true,
                                  show_date: true,
                                  show_author: true,
                                  show_tags: true
                                %}
                              </div>
                            {%- endfor -%}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </tab-component>
            {%- endif -%}
          </template>

          {%- if show_products == true and default_tab == 'products' -%}
            <tab-component class='tab' aria-hidden='false' data-id='products'>
              <sidebar-filters-sticky-mobile-button class='shop-mobile-filters-button'>
                <button
                  data-sidebar-button
                  class='unstyled-button shop-mobile-filters-button__btn'
                  aria-label='{{ 'shop.screen_reader.label_for_filters_toggler' | t }}'
                  data-sidebar-id='SidebarFiltersMobile'
                  data-aria-expanded='false'
                >
                  {% render 'icon', icon_name: 'filter-toggle' %}
                  <span class='shop-mobile-filters-button__btn-label'>
                    {{ 'shop.store_front.label_for_filters_toggler' | t }}
                  </span>
                </button>
              </sidebar-filters-sticky-mobile-button>

              <shop-component
                class='shop'
                data-base-params='{{ base_params }}'
                data-section-id='{{ section.id }}'
                data-column-switcher-target
              >
                <div class='shop__container'>
                  <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                    <div class='shop__header-left-panel {% if filters_position == 'right' %} shop__header-left-panel--reverse {% endif %}'>
                      {%- if enable_filtering or enable_sorting -%}
                        {%- if enable_filtering -%}
                          <sidebar-button class='shop__filters-btn-wrapper shop__filters-btn-wrapper--desktop'>
                            <button
                              data-sidebar-button
                              class='unstyled-button shop__icon-btn shop__filters-btn '
                              aria-label='{{ 'general.search_page.screen_reader.label_for_filters_toggler' | t }}'
                              data-sidebar-id='SidebarFiltersDesktop'
                              data-aria-expanded='{% if filter_style == 'open-embed' %}true{% else %}false{% endif %}'
                            >
                              {% render 'icon', icon_name: 'filter-toggle' %}
                              <span class='shop__filters-btn-label'>
                                {{ 'general.search_page.store_front.label_for_filters_toggler' | t }}
                              </span>
                            </button>
                          </sidebar-button>
                          <sidebar-button class='shop__filters-btn-wrapper shop__filters-btn-wrapper--mobile'>
                            <button
                              data-sidebar-button
                              class='unstyled-button shop__icon-btn shop__filters-btn '
                              aria-label='{{ 'general.search_page.screen_reader.label_for_filters_toggler' | t }}'
                              data-sidebar-id='SidebarFiltersMobile'
                              data-aria-expanded='false'
                            >
                              {% render 'icon', icon_name: 'filter-toggle' %}
                              <span class='shop__filters-btn-label'>
                                {{ 'general.search_page.store_front.label_for_filters_toggler' | t }}
                              </span>
                            </button>
                          </sidebar-button>
                        {%- endif -%}
                        {%- if enable_sorting -%}
                          {% render 'sort-list', results: search %}
                        {%- endif -%}
                      {%- endif -%}
                    </div>
                    <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                      {%- if show_results_count -%}
                        <div class='shop__product-count' id='ShopProductCount'>
                          {{ 'general.search_page.store_front.results_count' | t: count: product_count }}
                        </div>
                      {%- endif -%}
                      {%- if show_column_count_switcher -%}
                        <column-switcher
                          class='shop__column-switcher--mobile column-switcher'
                          data-default='{{ mobile_columns }}'
                          data-column-switcher-css-variable='mobile-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (1..2) -%}
                            {%- assign column_switch_string = column_switch | append: '' -%}
                            <div
                              class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {% endfor -%}
                        </column-switcher>
                      {%- endif -%}
                      {%- if show_column_count_switcher -%}
                        <column-switcher
                          class='shop__column-switcher--desktop column-switcher'
                          data-default='{{ desktop_columns }}'
                          data-column-switcher-css-variable='desktop-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (2..4) -%}
                            {%- assign column_switch_string = column_switch | append: '' -%}
                            <div
                              class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {%- endfor -%}
                        </column-switcher>
                      {%- endif -%}
                    </div>
                  </div>
                  {%- if enable_filtering -%}
                    {% render 'active-filters',
                      results: search,
                      has_price_filtering: has_price_filtering,
                      active_filter_count: active_filter_count
                    %}
                  {%- endif -%}
                  <div class='shop__content'>
                    {%- if enable_filtering -%}
                      {% render 'filters',
                        active_filter_count: active_filter_count,
                        show_divider: show_divider,
                        filter_style: filter_style,
                        categories_style: categories_style,
                        filters_position: filters_position,
                        show_color_swatches: show_color_swatches,
                        option_style: option_style,
                        enable_uppercase_title: enable_uppercase_title,
                        initial_visible_option_count: initial_visible_option_count,
                        results: search
                      %}
                    {%- endif -%}
                    <div class='shop__products' id='ShopProducts'>
                      {% paginate search.results by product_per_page %}
                        {%- if search.results.size > 0 -%}
                          <div class='shop__products-grid-wrap'>
                            <div class='shop__products-grid' id='ShopProductsGrid'>
                              {%- for item in search.results -%}
                                {%- comment %}<locksmith:459f>{% endcomment -%}
                                  {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: item, subject_parent: search, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                                {%- comment %}</locksmith:459f>{% endcomment -%}
                                {%- if item.object_type == 'product' -%}
                                  <div class='main-search__item shop__grid-item'>
                                    {% render 'product-card',
                                      with_bottom_spacing: true,
                                      product: item,
                                      show_mobile_carousel: true,
                                      img_ratio: img_ratio,
                                      product_card_align: product_card_align
                                    %}
                                  </div>
                                {%- endif -%}
                              {%- endfor -%}
                            </div>
                            {% render 'loading-overlay', class: 'shop__loading-overlay', id: 'ShopProductsOverlay' %}
                          </div>
                        {%- else -%}
                          {%- if active_filter_count > 0 -%}
                            <div class='shop__products-stub'>
                              <span>{{ 'general.search_page.store_front.text_for_no_results_found_in_stub' | t }}</span>
                              <span>
                                {{- 'general.search_page.store_front.text_for_use_another_filters' | t }}
                                <filter-remove-btn class='shop__filters-reset' data-url='{{ routes.search_url }}'>
                                  {{- 'general.search_page.store_front.text_for_clear_all_in_stub' | t -}}
                                </filter-remove-btn></span
                              >
                              {% render 'loading-overlay', class: 'shop__loading-overlay', id: 'ShopProductsOverlay' %}
                            </div>
                          {%- else -%}
                            <div class='shop__products-stub'>
                              <span>{{ 'general.search_page.store_front.text_for_change_query' | t }}</span>
                              {% render 'loading-overlay', class: 'shop__loading-overlay', id: 'ShopProductsOverlay' %}
                            </div>
                          {%- endif -%}
                        {%- endif -%}
                        {%- liquid
                          if paginate.pages > 1
                            case pagination_type
                              when 'load-button-pagination'
                                render 'load-button-pagination', class: 'shop__load-button-pagination', paginate: paginate, target: 'shop__grid-item', container_id: 'ShopProductsGrid', all_count: product_count, current_size: paginate.page_size
                              when 'classic-pagination'
                                render 'classic-pagination', class: 'shop__classic-pagination', paginate: paginate, overlay_id: 'ShopProductsOverlay', container_id: 'ShopProductsGrid'
                              when 'infinite-scroll'
                                render 'infinite-scroll-pagination', class: '', paginate: paginate, target: 'shop__grid-item', container_id: 'ShopProductsGrid'
                            endcase
                          endif
                        -%}
                      {% endpaginate %}
                    </div>
                  </div>
                </div>
              </shop-component>
            </tab-component>
          {%- endif -%}
          {%- if show_pages == true and default_tab == 'pages' -%}
            <tab-component class='tab' aria-hidden='false' data-id='pages'>
              <div class='shop' data-column-switcher-target>
                <div class='shop__container'>
                  <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                    <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                      {%- if show_results_count -%}
                        <div class='shop__product-count'>
                          {{ 'general.search_page.store_front.results_count' | t: count: page_count }}
                        </div>
                      {%- endif -%}
                      {%- if show_column_count_switcher -%}
                        <column-switcher
                          class='shop__column-switcher--mobile column-switcher'
                          data-default='{{ mobile_columns }}'
                          data-column-switcher-css-variable='mobile-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (1..2) -%}
                            {%- assign column_switch_string = column_switch | append: '' -%}
                            <div
                              class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {%- endfor -%}
                        </column-switcher>
                      {%- endif -%}
                      {%- if show_column_count_switcher %}
                        <column-switcher
                          class='shop__column-switcher--desktop column-switcher'
                          data-default='{{ desktop_columns }}'
                          data-column-switcher-css-variable='desktop-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (2..4) -%}
                            {%- assign column_switch_string = column_switch | append: '' -%}
                            <div
                              class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {%- endfor -%}
                        </column-switcher>
                      {%- endif -%}
                    </div>
                  </div>
                  <div class='shop__content'>
                    <div class='shop__products'>
                      <div class='shop__products-grid-wrap'>
                        <div class='shop__products-grid'>
                          {%- for page in page_list -%}
                            {%- comment %}<locksmith:2a91>{% endcomment -%}
                              {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: page, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                            {%- comment %}</locksmith:2a91>{% endcomment -%}
                            <div class='main-search__item shop__grid-item'>
                              {%- render 'page-card', page: page, img_ratio: img_ratio, with_small_icon: false -%}
                            </div>
                          {%- endfor -%}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </tab-component>
          {%- endif -%}
          {%- if show_articles == true and default_tab == 'articles' -%}
            <tab-component class='tab' aria-hidden='false' data-id='articles'>
              <div class='shop' data-column-switcher-target>
                <div class='shop__container'>
                  <div class='shop__header {% if filters_position == 'right' %} shop__header--reverse {% endif %}'>
                    <div class='shop__header-right-panel {% if filters_position == 'right' %} shop__header-right-panel--reverse {% endif %}'>
                      {%- if show_results_count -%}
                        <div class='shop__product-count'>
                          {{ 'general.search_page.store_front.results_count' | t: count: article_count }}
                        </div>
                      {%- endif -%}
                      {%- if show_column_count_switcher -%}
                        <column-switcher
                          class='shop__column-switcher--mobile column-switcher'
                          data-default='{{ mobile_columns }}'
                          data-column-switcher-css-variable='mobile-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (1..2) -%}
                            {%- assign column_switch_string = column_switch | append: '' -%}
                            <div
                              class='column-switcher__item {% if mobile_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {%- endfor -%}
                        </column-switcher>
                      {%- endif -%}
                      {%- if show_column_count_switcher -%}
                        <column-switcher
                          class='shop__column-switcher--desktop column-switcher'
                          data-default='{{ desktop_columns }}'
                          data-column-switcher-css-variable='desktop-columns'
                          data-section-id='{{ section.id }}'
                        >
                          {%- for column_switch in (2..4) -%}
                            {%- assign column_switch_string = column_switch | append: '' %}
                            <div
                              class='column-switcher__item {% if desktop_columns == column_switch_string %}selected{% endif %}'
                              data-column-switcher-item
                              tabindex='0'
                              data-value='{{ column_switch }}'
                            >
                              {%- for i in (1..column_switch) -%}
                                <span></span>
                              {%- endfor -%}
                            </div>
                          {%- endfor -%}
                        </column-switcher>
                      {%- endif -%}
                    </div>
                  </div>
                  <div class='shop__content'>
                    <div class='shop__products'>
                      <div class='shop__products-grid-wrap'>
                        <div class='shop__products-grid'>
                          {%- for article in article_list -%}
                            {%- comment %}<locksmith:b629>{% endcomment -%}
                              {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: article, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                            {%- comment %}</locksmith:b629>{% endcomment -%}
                            <div class='main-search__item shop__grid-item'>
                              {% render 'article-card',
                                with_bottom_spacing: true,
                                article: article,
                                img_ratio: img_ratio,
                                show_read_more: true,
                                show_subheading: true,
                                show_comment_count: true,
                                show_date: true,
                                show_author: true,
                                show_tags: true
                              %}
                            </div>
                          {%- endfor -%}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </tab-component>
          {%- endif -%}
        </div>
      </tabs-component>
    </div>
  {%- elsif search.terms != blank -%}
    <div class='container container--small'>
      <div class='search__no-results-note'>
        {{ 'general.search_page.store_front.text_for_no_results' | t: search_query: search.terms }}
      </div>
    </div>
  {%- endif -%}
</div>

{% render 'save-section-data-in-global-scope', section: section %}

{% schema %}
{
  "name": "t:sections.search.name",
  "tag": "section",
  "settings": [
    {
      "type": "paragraph",
      "content": "t:sections.search.description.content"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "default",
          "label": "t:sections.general_section_settings.color_scheme_option_default_label"
        },
        {
          "value": "primary",
          "label": "t:sections.general_section_settings.color_scheme_option_primary_label"
        },
        {
          "value": "secondary",
          "label": "t:sections.general_section_settings.color_scheme_option_secondary_label"
        },
        {
          "value": "custom-1",
          "label": "t:sections.general_section_settings.color_scheme_option_custom_1_label"
        },
        {
          "value": "custom-2",
          "label": "t:sections.general_section_settings.color_scheme_option_custom_2_label"
        },
        {
          "value": "custom-3",
          "label": "t:sections.general_section_settings.color_scheme_option_custom_3_label"
        },
        {
          "value": "white",
          "label": "t:sections.general_section_settings.color_scheme_option_white_text_label"
        },
        {
          "value": "black",
          "label": "t:sections.general_section_settings.color_scheme_option_black_text_label"
        }
      ],
      "default": "default",
      "label": "t:sections.general_section_settings.color_scheme_label",
      "info": "t:sections.general_section_settings.color_scheme_tip"
    },
    {
      "type": "select",
      "id": "container_size",
      "options": [
        {
          "value": "full-screen",
          "label": "t:sections.general_section_settings.container_size.screen_width_option"
        },
        {
          "value": "page-width",
          "label": "t:sections.general_section_settings.container_size.page_width_option"
        },
        {
          "value": "large",
          "label": "t:sections.general_section_settings.container_size.large_width_option"
        },
        {
          "value": "medium",
          "label": "t:sections.general_section_settings.container_size.medium_width_option"
        },
        {
          "value": "small",
          "label": "t:sections.general_section_settings.container_size.small_width_option"
        },
        {
          "value": "xsmall",
          "label": "t:sections.general_section_settings.container_size.extra_small_width_option"
        }
      ],
      "default": "large",
      "label": "t:sections.general_section_settings.container_size.label"
    },
    {
      "type": "range",
      "id": "section_spacing_top",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 64,
      "unit": "t:sections.general_section_settings.section_spacing_top.unit",
      "label": "t:sections.general_section_settings.section_spacing_top.label"
    },
    {
      "type": "range",
      "id": "section_spacing_bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 64,
      "unit": "t:sections.general_section_settings.section_spacing_bottom.unit",
      "label": "t:sections.general_section_settings.section_spacing_bottom.label"
    },
    {
      "type": "header",
      "content": "t:sections.search.sorter_settings_header"
    },
    {
      "type": "checkbox",
      "id": "enable_sorting",
      "default": true,
      "label": "t:sections.search.label_for_enable_sorting_setting"
    },
    {
      "type": "checkbox",
      "id": "show_results_count",
      "default": true,
      "label": "t:sections.search.label_for_show_results_count_setting"
    },
    {
      "type": "checkbox",
      "id": "show_column_count_switcher",
      "default": true,
      "label": "t:sections.search.label_for_show_column_count_switcher_setting"
    },
    {
      "type": "header",
      "content": "t:sections.search.filter_settings_header"
    },
    {
      "type": "paragraph",
      "content": "t:sections.search.filter_settings_description"
    },
    {
      "type": "checkbox",
      "id": "enable_filtering",
      "default": true,
      "label": "t:sections.search.label_for_enable_filtering_setting",
      "info": "t:sections.search.info_for_enable_filtering_setting"
    },
    {
      "type": "select",
      "id": "filters_position",
      "options": [
        {
          "value": "left",
          "label": "t:sections.search.filters_position.option_1"
        },
        {
          "value": "right",
          "label": "t:sections.search.filters_position.option_2"
        }
      ],
      "default": "left",
      "label": "t:sections.search.filters_position.label",
      "info": "t:sections.search.filters_position.info"
    },
    {
      "type": "select",
      "id": "filter_style",
      "options": [
        {
          "value": "drawer",
          "label": "t:sections.search.filter_style.option_1"
        },
        {
          "value": "open-embed",
          "label": "t:sections.search.filter_style.option_2"
        },
        {
          "value": "closed-embed",
          "label": "t:sections.search.filter_style.option_3"
        }
      ],
      "default": "drawer",
      "label": "t:sections.search.filter_style.label"
    },
    {
      "type": "select",
      "id": "categories_style",
      "options": [
        {
          "value": "static",
          "label": "t:sections.search.categories_style.option_1"
        },
        {
          "value": "expanded_tabs",
          "label": "t:sections.search.categories_style.option_2"
        },
        {
          "value": "collapsed_tabs",
          "label": "t:sections.search.categories_style.option_3"
        }
      ],
      "default": "static",
      "label": "t:sections.search.categories_style.label"
    },
    {
      "type": "select",
      "id": "option_style",
      "options": [
        {
          "value": "checkbox-solid",
          "label": "t:sections.search.label_for_checkbox_solid_option_in_option_style_setting"
        },
        {
          "value": "checkbox-outline",
          "label": "t:sections.search.label_for_checkbox_outline_option_in_option_style_setting"
        },
        {
          "value": "button-solid",
          "label": "t:sections.search.label_for_button_solid_option_in_option_style_setting"
        },
        {
          "value": "button-outline",
          "label": "t:sections.search.label_for_button_outline_option_in_option_style_setting"
        },
        {
          "value": "text",
          "label": "t:sections.search.label_for_text_option_in_option_style_setting"
        }
      ],
      "default": "checkbox-outline",
      "label": "t:sections.search.label_for_option_style_setting"
    },
    {
      "type": "checkbox",
      "id": "show_color_swatches",
      "default": true,
      "label": "t:sections.search.label_for_show_color_swatches_setting",
      "info": "t:sections.search.info_for_show_color_swatches_setting"
    },
    {
      "type": "checkbox",
      "id": "show_divider",
      "default": true,
      "label": "t:sections.search.label_for_show_divider_setting"
    },
    {
      "type": "checkbox",
      "id": "enable_uppercase_title",
      "default": true,
      "label": "t:sections.search.label_for_enable_uppercase_title_setting"
    },
    {
      "type": "header",
      "content": "t:sections.search.cards_settings_header"
    },
    {
      "type": "select",
      "id": "img_ratio",
      "options": [
        {
          "value": "default",
          "label": "t:sections.general_section_settings.img_ratio_option_default_label"
        },
        {
          "value": "square",
          "label": "t:sections.general_section_settings.img_ratio_option_fill_square_label"
        },
        {
          "value": "portrait",
          "label": "t:sections.general_section_settings.img_ratio_option_fill_portrait_label"
        },
        {
          "value": "portrait-xl",
          "label": "t:sections.general_section_settings.img_ratio_option_fill_portrait_xl_label"
        },
        {
          "value": "landscape",
          "label": "t:sections.general_section_settings.img_ratio_option_fill_landscape_label"
        },
        {
          "value": "fit-square",
          "label": "t:sections.general_section_settings.img_ratio_option_fit_square_label"
        },
        {
          "value": "fit-portrait",
          "label": "t:sections.general_section_settings.img_ratio_option_fit_portrait_label"
        },
        {
          "value": "fit-portrait-xl",
          "label": "t:sections.general_section_settings.img_ratio_option_fit_portrait_xl_label"
        },
        {
          "value": "fit-landscape",
          "label": "t:sections.general_section_settings.img_ratio_option_fit_landscape_label"
        }
      ],
      "default": "portrait-xl",
      "label": "t:sections.general_section_settings.img_ratio_label"
    },
    {
      "type": "select",
      "id": "product_card_align",
      "label": "t:sections.general_section_settings.content_alignment_label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.general_section_settings.alignment_option_left_label"
        },
        {
          "value": "center",
          "label": "t:sections.general_section_settings.alignment_option_center_label"
        }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "product_per_page",
      "min": 12,
      "max": 50,
      "step": 2,
      "default": 16,
      "label": "t:sections.search.label_for_product_per_page_setting"
    },
    {
      "type": "select",
      "id": "desktop_columns",
      "options": [
        {
          "value": "2",
          "label": "2"
        },
        {
          "value": "3",
          "label": "3"
        },
        {
          "value": "4",
          "label": "4"
        }
      ],
      "default": "3",
      "label": "t:sections.search.label_for_desktop_columns_setting"
    },
    {
      "type": "range",
      "id": "desktop_space_between_cards",
      "min": 0,
      "max": 32,
      "step": 1,
      "default": 12,
      "unit": "t:sections.search.unit_for_desktop_space_between_cards_setting",
      "label": "t:sections.search.label_for_desktop_space_between_cards_setting"
    },
    {
      "type": "select",
      "id": "mobile_columns",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        }
      ],
      "default": "2",
      "label": "t:sections.search.label_for_mobile_columns_setting"
    },
    {
      "type": "range",
      "id": "mobile_space_between_cards",
      "min": 0,
      "max": 32,
      "step": 4,
      "default": 20,
      "unit": "t:sections.search.unit_for_mobile_space_between_cards_setting",
      "label": "t:sections.search.label_for_mobile_space_between_cards_setting"
    },
    {
      "type": "select",
      "id": "pagination_type",
      "options": [
        {
          "value": "infinite-scroll",
          "label": "t:sections.general_section_settings.pagination_type_option_infinite_scroll_label"
        },
        {
          "value": "load-button-pagination",
          "label": "t:sections.general_section_settings.pagination_type_option_click_to_load_label"
        },
        {
          "value": "classic-pagination",
          "label": "t:sections.general_section_settings.pagination_type_option_classic_pagination_label"
        }
      ],
      "default": "load-button-pagination",
      "label": "t:sections.general_section_settings.pagination_type_label"
    }
  ]
}
{% endschema %}
